
================================================================================
  TABLE 3: Expected Cost & Latency Comparison
================================================================================

────────────────────────────────────────────────────────────────────────────────
  [A] Observed Violation Statistics
────────────────────────────────────────────────────────────────────────────────
  Total sessions:       300
  Normal:               80
  Violation:            220
  pv (violation rate):  0.7333
  pd (detection rate):  0.3864  (1 - FNR)
  pfp (FPR):            0.0000  (0/80)
  FNR:                  0.6136  (135/220)

  Per-Violation Detection:
  Type      Total Detected     Rate
  ──────── ────── ──────── ────────
  V1           50       39   78.00%
  V2           60       15   25.00%
  V3           50       16   32.00%
  V4           30        0    0.00%
  V5           30       15   50.00%

────────────────────────────────────────────────────────────────────────────────
  [B] Component Latencies (ms)
────────────────────────────────────────────────────────────────────────────────
  Component                          Mean   Median      P95      N
  ────────────────────────────── ──────── ──────── ──────── ──────
  Cg: Generation (GPT)             1081.3   1014.4   1462.6    300
  Cd: Detection (RoBERTa)            27.1     26.3     30.1    300
  Cr: Rewrite (when triggered)     3985.2   4250.9   5586.3     85
  Cj: Judge (GPT-4o-mini)           459.8    418.9    655.5    300

  Rewrite triggered:   85 sessions
  Avg retries/trigger: 2.65

────────────────────────────────────────────────────────────────────────────────
  [C] Expected Cost per Session (latency, ms)
────────────────────────────────────────────────────────────────────────────────

  Formula:
    E[C_ours]  = Cg + Cd + (pv·pd + pfp) · Cr
    E[C_judge] = Cg + Cj

  Parameters:
    Cg  =   1081.3 ms   (response generation)
    Cd  =     27.1 ms   (RoBERTa detection)
    Cr  =   3985.2 ms   (rewrite when flagged)
    Cj  =    459.8 ms   (LLM judge evaluation)
    pv  =   0.7333       (violation probability)
    pd  =   0.3864       (detection rate)
    pfp =   0.0000       (false positive rate)
    P(rewrite) = pv·pd + pfp = 0.2833

  ┌─────────────────────────────────────────────────────────┐
  │  E[C_ours]  = 1081.3 + 27.1 + 0.2833 × 3985.2
  │             = 2237.5 ms
  │
  │  E[C_judge] = 1081.3 + 459.8
  │             = 1541.0 ms
  └─────────────────────────────────────────────────────────┘

────────────────────────────────────────────────────────────────────────────────
  [D] Savings Summary
────────────────────────────────────────────────────────────────────────────────
  Our System (expected):       2237.5 ms
  LLM-Judge (expected):        1541.0 ms
  Savings:                     -696.5 ms  (-45.2%)

  Fast path (no violation): 1108.4 ms  (Cg + Cd only)
  Slow path (rewrite):      5093.6 ms  (Cg + Cd + Cr)
  Judge always:             1541.0 ms  (Cg + Cj always)

────────────────────────────────────────────────────────────────────────────────
  [E] Gold-Corrected Analysis (pd=1.0, pfp=0.0)
────────────────────────────────────────────────────────────────────────────────

  NOTE: Section [A]의 pd/pfp는 experiment_log.jsonl 기반 (GPT 생성 응답).
        Gold 테스트에서 모델은 pd=1.0 (100% 탐지), pfp=0.0 (0% 오탐).
        여기서는 Gold 기준 pd/pfp로 보정된 기대 비용을 계산합니다.

  Gold-corrected parameters:
    pd  = 1.0000  (Gold test: 100% detection)
    pfp = 0.0000  (Gold test: 0% false positive)
    P(rewrite) = pv × pd + pfp = 0.7333

  ┌─────────────────────────────────────────────────────────┐
  │  E[C_ours]  = 1081.3 + 27.1 + 0.7333 × 3985.2
  │             = 4030.9 ms
  │  E[C_judge] = 1541.0 ms
  │  Savings    = -2489.9 ms  (-161.6%)
  └─────────────────────────────────────────────────────────┘

  Breakeven: Our system = Judge when pv = 0.1086  (10.9%)
  → 위반율이 10.9% 미만이면 Our System이 더 저렴

================================================================================

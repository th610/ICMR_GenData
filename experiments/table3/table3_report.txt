
================================================================================
  TABLE 3: Expected Cost & Latency Comparison
================================================================================

────────────────────────────────────────────────────────────────────────────────
  [A] Observed Violation Statistics
────────────────────────────────────────────────────────────────────────────────
  Total sessions:       600
  Normal:               160
  Violation:            440
  pv (violation rate):  0.7333
  pd (detection rate):  0.5591  (1 - FNR)
  pfp (FPR):            0.0125  (2/160)
  FNR:                  0.4409  (194/440)

  Per-Violation Detection:
  Type      Total Detected     Rate
  ──────── ────── ──────── ────────
  V1          100       85   85.00%
  V2          120       38   31.67%
  V3          100       59   59.00%
  V4           60       24   40.00%
  V5           60       40   66.67%

────────────────────────────────────────────────────────────────────────────────
  [B] Component Latencies (ms)
────────────────────────────────────────────────────────────────────────────────
  Component                          Mean   Median      P95      N
  ────────────────────────────── ──────── ──────── ──────── ──────
  Cg: Generation (GPT)             1493.2   1234.0   3177.7    600
  Cd: Detection (RoBERTa)            29.1     27.1     35.5    600
  Cr: Rewrite (when triggered)     6496.3   5603.0  11623.0    248
  Cj: Judge (GPT-4o-mini)           878.8    781.5   1694.9    300

  Rewrite triggered:   248 sessions
  Avg retries/trigger: 2.64

────────────────────────────────────────────────────────────────────────────────
  [C] Expected Cost per Session (latency, ms)
────────────────────────────────────────────────────────────────────────────────

  Formula:
    E[C_ours]  = Cg + Cd + (pv·pd + pfp) · Cr
    E[C_judge] = Cg + Cj

  Parameters:
    Cg  =   1493.2 ms   (response generation)
    Cd  =     29.1 ms   (RoBERTa detection)
    Cr  =   6496.3 ms   (rewrite when flagged)
    Cj  =    878.8 ms   (LLM judge evaluation)
    pv  =   0.7333       (violation probability)
    pd  =   0.5591       (detection rate)
    pfp =   0.0125       (false positive rate)
    P(rewrite) = pv·pd + pfp = 0.4225

  ┌─────────────────────────────────────────────────────────┐
  │  E[C_ours]  = 1493.2 + 29.1 + 0.4225 × 6496.3
  │             = 4266.9 ms
  │
  │  E[C_judge] = 1493.2 + 878.8
  │             = 2371.9 ms
  └─────────────────────────────────────────────────────────┘

────────────────────────────────────────────────────────────────────────────────
  [D] Savings Summary
────────────────────────────────────────────────────────────────────────────────
  Our System (expected):       4266.9 ms
  LLM-Judge (expected):        2371.9 ms
  Savings:                    -1895.0 ms  (-79.9%)

  Fast path (no violation): 1522.2 ms  (Cg + Cd only)
  Slow path (rewrite):      8018.5 ms  (Cg + Cd + Cr)
  Judge always:             2371.9 ms  (Cg + Cj always)

────────────────────────────────────────────────────────────────────────────────
  [E] Gold-Corrected Analysis (pd=1.0, pfp=0.0)
────────────────────────────────────────────────────────────────────────────────

  NOTE: Section [A]의 pd/pfp는 experiment_log.jsonl 기반 (GPT 생성 응답).
        Gold 테스트에서 모델은 pd=1.0 (100% 탐지), pfp=0.0 (0% 오탐).
        여기서는 Gold 기준 pd/pfp로 보정된 기대 비용을 계산합니다.

  Gold-corrected parameters:
    pd  = 1.0000  (Gold test: 100% detection)
    pfp = 0.0000  (Gold test: 0% false positive)
    P(rewrite) = pv × pd + pfp = 0.7333

  ┌─────────────────────────────────────────────────────────┐
  │  E[C_ours]  = 1493.2 + 29.1 + 0.7333 × 6496.3
  │             = 6286.2 ms
  │  E[C_judge] = 2371.9 ms
  │  Savings    = -3914.3 ms  (-165.0%)
  └─────────────────────────────────────────────────────────┘

  Breakeven: Our system = Judge when pv = 0.1308  (13.1%)
  → 위반율이 13.1% 미만이면 Our System이 더 저렴

================================================================================
